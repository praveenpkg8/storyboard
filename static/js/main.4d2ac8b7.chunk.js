(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{28:function(e,t,a){e.exports=a(41)},34:function(e,t,a){},40:function(e,t,a){},41:function(e,t,a){"use strict";a.r(t);var n,r,s=a(0),c=a.n(s),o=a(25),i=a.n(o),l=(a(33),a(34),a(2)),u=a(3),m=a(5),p=a(4),d=a(6),h=a(14),b=a(16),g=a(1),f=a.n(g),v=a(7),E=a(12),y=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).googeOAuth=Object(v.a)(f.a.mark(function e(){return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.setState({redirect:!0});case 1:case"end":return e.stop()}},e)})),a.state={redirect:!1},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return this.state.redirect?c.a.createElement(h.a,{to:"http://localhost:8080/profile/google"}):c.a.createElement(c.a.Fragment,null,c.a.createElement("a",{href:"http://localhost:8080/profile/google",className:"btn btn-outline-warning"}," Google"))}}]),t}(s.Component),j=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).handleChange=function(e){var t=e.target,n=t.name,r=t.value;a.setState(Object(E.a)({},n,r))},a.onSignup=Object(v.a)(f.a.mark(function e(){var t,n;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({name:a.state.name,mail:a.state.mail,password:a.state.password})},e.next=3,fetch("/profile/signup",t).then(function(e){return e.json()});case 3:return n=e.sent,a.setState({name:"",mail:"",password:""}),console.log(n),e.abrupt("return",c.a.createElement(h.a,{to:"/signin"}));case 7:case"end":return e.stop()}},e)})),a.state={name:"",mail:"",password:""},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"card w-50"},c.a.createElement("h5",{className:"card-header"},"SignUp"),c.a.createElement("div",{className:"card-body"},c.a.createElement("div",{className:"input-group mb-3"},c.a.createElement("div",{className:"input-group-prepend"},c.a.createElement("span",{className:"input-group-text"},"Name")),c.a.createElement("input",{name:"name",type:"text",className:"form-control",value:this.state.name,onChange:this.handleChange})),c.a.createElement("div",{className:"input-group mb-3"},c.a.createElement("div",{className:"input-group-prepend"},c.a.createElement("span",{className:"input-group-text"},"Mail Id")),c.a.createElement("input",{name:"mail",type:"mail",className:"form-control",value:this.state.mail,onChange:this.handleChange})),c.a.createElement("div",{className:"input-group mb-3"},c.a.createElement("div",{className:"input-group-prepend"},c.a.createElement("span",{className:"input-group-text"},"Password")),c.a.createElement("input",{name:"password",type:"password",className:"form-control",value:this.state.password,onChange:this.handleChange})),c.a.createElement("button",{className:"btn btn-outline-info",onClick:this.onSignup},"Login"),c.a.createElement("h4",null,"Sign Up with ",c.a.createElement(y,null)))))}}]),t}(s.Component),O="/profile/signin",k=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).handleChange=function(e){var t=e.target,n=t.name,r=t.value;a.setState(Object(E.a)({},n,r))},a.onSignin=Object(v.a)(f.a.mark(function e(){var t,n;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({mail:a.state.mail,password:a.state.password})},e.next=3,fetch(O,t).then(function(e){return e.json().then(function(t){return{data:t,status:e.status}})});case 3:if(n=e.sent,a.setState({mail:"",password:""}),200!==n.status){e.next=10;break}document.cookie="session="+n.data.session,a.setState({redirect:!0}),e.next=11;break;case 10:return e.abrupt("return",c.a.createElement(h.a,{to:"/signin"}));case 11:case"end":return e.stop()}},e)})),a.state={mail:"",password:"",redirect:!1},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return this.state.redirect?c.a.createElement(h.a,{to:"/profile"}):c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"card w-50"},c.a.createElement("h5",{className:"card-header"},"SignIn"),c.a.createElement("div",{className:"card-body"},c.a.createElement("div",{className:"input-group mb-3"},c.a.createElement("div",{className:"input-group-prepend"},c.a.createElement("span",{className:"input-group-text"},"Mail Id")),c.a.createElement("input",{name:"mail",type:"mail",className:"form-control",value:this.state.mail,onChange:this.handleChange})),c.a.createElement("div",{className:"input-group mb-3"},c.a.createElement("div",{className:"input-group-prepend"},c.a.createElement("span",{className:"input-group-text"},"Password")),c.a.createElement("input",{name:"password",type:"password",className:"form-control",value:this.state.password,onChange:this.handleChange})),c.a.createElement("button",{className:"btn btn-outline-info",onClick:this.onSignin},"Login"),c.a.createElement("h4",null,"Login with ",c.a.createElement(y,null)))))}}]),t}(s.Component),N=a(15),w=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).comment=a.props.comment,a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.comment;return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",null,c.a.createElement("span",{className:"badge badge-pill badge-secondary"},e.name),"  ",e.comment,c.a.createElement("hr",null)))}}]),t}(s.Component),x=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).handleChange=function(e){var t=e.target,n=t.name,r=t.value;a.setState(Object(E.a)({},n,r))},a.state={comment:"",user:e.user,stories:e.stories},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"postComment",value:function(){var e=Object(v.a)(f.a.mark(function e(){var t,a,n;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.user,a=this.state.stories,n={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({story_id:a.story_id,mail:t.mail,name:t.name,comment:this.state.comment})},e.next=5,fetch("/api/comment",n);case 5:e.sent,this.setState({comment:""});case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"input-group mb-3"},c.a.createElement("input",{name:"comment",type:"text",value:this.state.comment,onChange:this.handleChange,className:"form-control",placeholder:"Comment","aria-label":"Comment","aria-describedby":"button-addon2"}),c.a.createElement("div",{className:"input-group-append"},c.a.createElement("button",{onClick:function(){return e.postComment()},className:"btn btn-outline-secondary"},"Comment"))))}}]),t}(s.Component),S=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).getNextCommment=Object(v.a)(f.a.mark(function e(){var t,n,r,s;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.state.comment_detials,console.log(a.state.story_id),n="/api/comment?story_id="+a.state.story_id+"&next_cursor="+t.next_cursor,e.next=5,fetch(n).then(function(e){return e.json()});case 5:r=e.sent,s=[].concat(Object(N.a)(t.comment),Object(N.a)(r.message)),console.log(s),a.setState({comments:s,comment_detials:r});case 9:case"end":return e.stop()}},e)})),a.state={comment_detials:e.commentDetials,story:e.story,story_id:e.story_id,comments:e.commentList},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.state.comment_detials,t=this.state.comments.map(function(e,t){return c.a.createElement(w,{key:t,comment:e})});return c.a.createElement(c.a.Fragment,null,c.a.createElement(x,{user:this.props.user,stories:this.state.story}),t,e.more?c.a.createElement("button",{type:"button",onClick:this.getNextCommment,className:"btn btn-link"},"Load Comment...."):c.a.createElement(c.a.Fragment,null))}}]),t}(s.Component),C=function(e){function t(e){return Object(l.a)(this,t),Object(m.a)(this,Object(p.a)(t).call(this,e))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return console.log("change"),c.a.createElement(c.a.Fragment,null)}}]),t}(S),_=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).updateLike=Object(v.a)(f.a.mark(function e(){var t,s,c,o,i;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("calling update like"),t=a.state.story,s=a.state.user,c="/api/like?story_id="+t.story_id+"&mail="+s.mail,e.next=6,fetch(c);case 6:return o=e.sent,e.next=9,o.json();case 9:i=e.sent,n=i.count,r=i.status,console.log(r,n),a.setState({like_count:i.count,liked:i.status});case 14:case"end":return e.stop()}},e)})),a.state={like_count:e.story.like_count,liked:e.story.liked,story:e.story,user:e.user},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return r=this.props.liked,c.a.createElement(c.a.Fragment,null,c.a.createElement(C,{key:this.state.liked}),c.a.createElement("span",{onClick:this.updateLike,className:"btn badge badge-primary"},this.state.liked?c.a.createElement(c.a.Fragment,null,"unlike"):c.a.createElement(c.a.Fragment,null,"like")," ",c.a.createElement("span",{className:"badge badge-primary"},this.state.like_count)))}}]),t}(s.Component),F=function(e){function t(e){return Object(l.a)(this,t),Object(m.a)(this,Object(p.a)(t).call(this,e))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.props.story;console.log(e),n=e.like_count,r=e.liked;var t=function(e){var t=new Date(e),a=new Date;return t.getDate()===a.getDate()?"Today "+t.toLocaleTimeString():t.getDate()===a.getDate()-1?"Yesterday "+t.toLocaleTimeString():t.toLocaleString()}(e.time);return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"card w-75"},c.a.createElement("div",{className:"card-body"},c.a.createElement("h5",{className:"card-title"},e.name),c.a.createElement("span",{className:"badge-inline badge-pill badge-light"},t),c.a.createElement("p",{className:"card-text"},e.story),c.a.createElement(_,{key:this.props.story.story_id,user:this.props.user,story:e}),c.a.createElement(S,{story:e,story_id:e.story_id,commentDetials:e.comments,commentList:e.comments.comment,user:this.props.user})),c.a.createElement("div",{className:"card-body"})))}}]),t}(s.Component),L=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).handleChange=function(e){var t=e.target,n=t.name,r=t.value;a.setState(Object(E.a)({},n,r))},a.state={story:"",name:e.user_detials.name,mail:e.user_detials.mail,user:e.user_detials,render:!0},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){}},{key:"postStory",value:function(){var e=Object(v.a)(f.a.mark(function e(){var t,a,n,r;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={name:this.state.name,mail:this.state.mail,story:this.state.story},a={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(t)},e.next=4,fetch("/api/story",a);case 4:return n=e.sent,e.next=7,n.json();case 7:return r=e.sent,200===n.status&&this.props.render(r),this.setState({story:""}),e.abrupt("return",n);case 11:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return c.a.createElement(c.a.Fragment,null,c.a.createElement("textarea",{name:"story",type:"textarea",className:"form-control",value:this.state.story,onChange:this.handleChange}),c.a.createElement("button",{className:"btn btn-warning",onClick:function(t){return e.postStory(t)}},"Post"))}}]),t}(s.Component),D="/api/story",T=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).handleChange=function(e){var t=e.target,n=t.name,r=t.value;a.setState(Object(E.a)({},n,r))},a.reRender=function(e){var t=a.state.stories,n=[e.message].concat(Object(N.a)(t));a.setState({stories:n})},a.getAllStories=Object(v.a)(f.a.mark(function e(){var t,n;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(D,{credentials:"include"});case 2:return t=e.sent,e.next=5,t.json();case 5:n=e.sent,a.setState({story_detials:n,stories:n.message,loadStories:!0});case 7:case"end":return e.stop()}},e)})),a.getNextStory=Object(v.a)(f.a.mark(function e(){var t,n,r,s,c;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.state.story_detials,n="/api/story?next_cursor="+t.next_cursor,e.next=4,fetch(n,{credentials:"include"});case 4:return r=e.sent,e.next=7,r.json();case 7:s=e.sent,c=[].concat(Object(N.a)(a.state.stories),Object(N.a)(s.message)),a.setState({story_detials:s,stories:c});case 10:case"end":return e.stop()}},e)})),a.state={stories:[],loadStories:!1,user:e.user,story:""},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"addNewStory",value:function(e){var t=this.state.stories,a=[e].concat(Object(N.a)(t));this.setState({stories:a})}},{key:"componentWillMount",value:function(){this.getAllStories()}},{key:"render",value:function(){var e=this;if(this.state.loadStories){var t=this.state.stories;console.log(t);var a=this.state.story_detials,n=t.map(function(t,a){return c.a.createElement(F,{key:t.story_id,story:t,user:e.state.user})});return console.log(n),c.a.createElement(c.a.Fragment,null,c.a.createElement(L,{user_detials:this.state.user,render:this.reRender}),n,a.more?c.a.createElement("button",{type:"button",onClick:this.getNextStory,className:"btn btn-link"},"Load Stories...."):c.a.createElement(c.a.Fragment,null))}return c.a.createElement(c.a.Fragment,null)}}]),t}(s.Component),A=a(13),M=a.n(A),P=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).onLogout=Object(v.a)(f.a.mark(function e(){var t,n;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=M.a.get("session"),e.next=3,fetch("/profile/signout?session="+t).then(function(e){return e.json()});case 3:n=e.sent,console.log(n),M.a.set("session",void 0),a.setState({render:!0});case 7:case"end":return e.stop()}},e)})),a.state={render:!1},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return this.state.render?c.a.createElement(h.a,{to:"/profile"}):c.a.createElement(c.a.Fragment,null,c.a.createElement("button",{className:"btn btn-outline-danger",onClick:this.onLogout},"Logout"))}}]),t}(s.Component);function J(){return c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"spinner-border text-primary",role:"status"},c.a.createElement("span",{className:"sr-only"},"Loading...")),c.a.createElement("div",{className:"spinner-border text-secondary",role:"status"},c.a.createElement("span",{className:"sr-only"},"Loading...")),c.a.createElement("div",{className:"spinner-border text-success",role:"status"},c.a.createElement("span",{className:"sr-only"},"Loading...")),c.a.createElement("div",{className:"spinner-border text-danger",role:"status"},c.a.createElement("span",{className:"sr-only"},"Loading...")),c.a.createElement("div",{className:"spinner-border text-warning",role:"status"},c.a.createElement("span",{className:"sr-only"},"Loading...")),c.a.createElement("div",{className:"spinner-border text-info",role:"status"},c.a.createElement("span",{className:"sr-only"},"Loading...")))}var I=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).state={user_detials:e.user},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return c.a.createElement(c.a.Fragment,null,c.a.createElement("h1",null,this.state.user_detials.name),c.a.createElement("h2",null,"Welcome Aboard ....!!!"))}}]),t}(s.Component),W=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).reRender=function(){a.setState({render:!a.state.render})},a.state={user:"",loaded:!1,story:"",render:!0,status:0},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"profile",value:function(){var e=Object(v.a)(f.a.mark(function e(){var t,a,n;return f.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("/profile",{credentials:"include"});case 2:return t=e.sent,e.next=5,t.json();case 5:return a=e.sent,e.next=8,t.status;case 8:n=e.sent,this.setState({user:a.message,loaded:!0,status:n});case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillMount",value:function(){this.profile()}},{key:"render",value:function(){return void 0!==M.a.get("session")&&200===this.state.status?this.state.loaded?c.a.createElement(c.a.Fragment,null,c.a.createElement("div",{className:"container"},c.a.createElement(I,{user:this.state.user}),c.a.createElement(P,null),c.a.createElement(T,{user:this.state.user}))):c.a.createElement("h1",null,"Loading........."):void 0===M.a.get("session")||""!==this.state.user||400===this.state.status?c.a.createElement(h.a,{to:"/landingpage"}):c.a.createElement(J,null)}}]),t}(s.Component),B=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(m.a)(this,Object(p.a)(t).call(this,e))).handleSignin=function(){var e=a.state.render;e||a.setState({render:!e})},a.handleSignup=function(){var e=a.state.render;e&&a.setState({render:!e})},a.state={render:!0},a}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return c.a.createElement("div",{className:"container"},c.a.createElement("br",null),c.a.createElement("br",null),c.a.createElement("div",{className:"btn-group",role:"group","aria-label":"Basic example"},c.a.createElement("button",{type:"button",onClick:this.handleSignin,className:"btn btn-secondary"},"SignIn"),c.a.createElement("button",{type:"button",onClick:this.handleSignup,className:"btn btn-secondary"},"SignUp")),c.a.createElement("br",null),c.a.createElement("br",null),this.state.render?c.a.createElement(k,null):c.a.createElement(j,null))}}]),t}(s.Component);function R(e){var t=e.match;return M.a.set("session",t.params.id),c.a.createElement(c.a.Fragment,null,c.a.createElement(h.a,{to:""}))}var U=function(e){function t(){return Object(l.a)(this,t),Object(m.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return c.a.createElement(c.a.Fragment,null,c.a.createElement(b.a,null,c.a.createElement(h.b,{path:"/signup",exact:!0,component:j}),c.a.createElement(h.b,{path:"/signin",exact:!0,component:k}),c.a.createElement(h.b,{path:"/",exact:!0,component:W}),c.a.createElement(h.b,{path:"/profile/",exact:!0,component:W}),c.a.createElement(h.b,{path:"/landingpage/",exact:!0,component:B}),c.a.createElement(h.b,{path:"/sign/:id",component:R})))}}]),t}(s.Component);a(40);var G=function(){return c.a.createElement(c.a.Fragment,null,c.a.createElement(U,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(c.a.createElement(G,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[28,1,2]]]);
//# sourceMappingURL=main.4d2ac8b7.chunk.js.map